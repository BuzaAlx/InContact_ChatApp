(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{159:function(e,t,n){},184:function(e,t,n){"use strict";n.r(t);var a,r=n(4),s=n(0),i=n.n(s),o=n(17),c=n.n(o),l=(n(159),n(58)),u=n(22),d=n(142),b=n(235),j=n(234),m=n(37),g=n(31),p=n(223),O=n(16),x=n(221),h=n(240),f=Object(x.a)((function(e){return Object(h.a)({container:{position:"absolute",zIndex:100,bottom:60}})})),v=Object(x.a)((function(e){return Object(h.a)({root:{background:"linear-gradient(90deg, rgba(2,0,36,1) 0%, rgba(0,0,0,1) 0%, rgba(121,9,117,0.40379901960784315) 85%);",border:0,borderRadius:3,boxShadow:"0 3px 5px 2px rgba(255, 105, 135, .3)",color:"white",height:"100vh",padding:"0",margin:0,justifyContent:"center"},container:{alignItems:"center",alignSelf:"center",flexDirection:"column"},leftBlock:{backgroundColor:"rgba(2,0,36,0.4);"},rightBlock:{},header:{minHeight:"50px",backgroundColor:"rgba(217, 20, 20, 0.4)"}})})),y=n(20),S=Object(x.a)((function(e){var t;return Object(h.a)({container:{display:"flex",flexDirection:"column",height:"100%"},main:(t={flexGrow:1,flexDirection:"column-reverse",height:"430px",overflowY:"scroll",paddingLeft:"10px",paddingRight:"10px"},Object(y.a)(t,e.breakpoints.down("sm"),{}),Object(y.a)(t,"&::-webkit-scrollbar",{width:"5px"}),Object(y.a)(t,"&::-webkit-scrollbar-track",{backgroundColor:"transparent",borderRadius:"10px"}),Object(y.a)(t,"&::-webkit-scrollbar-thumb",{borderRadius:"10px",visibility:"hidden;",background:"linear-gradient(#e66465, #9198e5);"}),Object(y.a)(t,"&:hover::-webkit-scrollbar-thumb",{visibility:"visible;",transition:"all 0.2s ease;"}),t),messagesHeader:{position:"relative"},logoutButton:{position:"absolute",right:"10px",color:"rgba(2,0,36,0.4);"},footer:{height:"50px",margin:"5px",borderRadius:"20px",backgroundColor:"rgba(255, 255, 255, 0.5);"},form:{display:"flex",justifyContent:"space-between",alignItems:"center"},input:{color:"black",width:"80%",height:"100%",marginLeft:"10px"},button:{color:"rgba(2,0,36,0.4);",marginRight:"5px"},messageBox:{padding:"10px",borderRadius:"15px",backgroundColor:"rgba(28, 21, 235, 0.2);",marginBottom:"10px"}})})),w=Object(x.a)((function(e){return Object(h.a)({messageText:Object(y.a)({padding:"10px",borderRadius:"15px",backgroundColor:"rgba(201,247,111, 0.8)",fontFamily:"'Work Sans', sans-serif;",fontWeight:200,wordWrap:"break-word",maxWidth:"300px",cursor:"pointer"},e.breakpoints.down("sm"),{maxWidth:"200px"}),selfMessageText:{backgroundColor:"rgba(92,204,204, 0.8);"},emoji:{fontFamily:"'Work Sans', sans-serif;",position:"absolute",top:"7px",right:"-10px",backgroundColor:"rgba(2,0,36,0.4);",color:e.palette.text.primary,borderRadius:"20px",padding:" 0 6px 0",fontSize:"0.8rem"},emojiRight:{position:"absolute",top:"10px",left:"-10px",backgroundColor:"rgba(2,0,36,0.4);",color:e.palette.text.primary,borderRadius:"20px",padding:" 0 2px 0",fontSize:"0.8rem"},reactionsBox:{display:"flex",flexWrap:"wrap",maxWidth:"100px",padding:"5px",justifyContent:"space-between",alignItems:"center",cursor:"pointer",backgroundColor:"rgb(255, 228, 196);"},messageBox:{paddingTop:"15px",position:"relative"},reaction:{transition:"all .2s ease","&:hover":{transform:"scale(1.2);"}}})})),k=Object(x.a)((function(e){var t;return Object(h.a)({userInfo:{maxWidth:"120px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},usersMarkup:{padding:10},table:{minWidth:650},chatSection:{width:"100%",height:"80vh"},headBG:{backgroundColor:"#e0e0e0"},borderRight500:{borderRight:"1px solid #e0e0e0"},latestMessageTimeBox:Object(y.a)({alignSelf:"flex-start",textAlign:"end"},e.breakpoints.down("sm"),{display:"none"}),onlineIcon:{width:"12px",height:"12px",right:"12px",background:"linear-gradient(0deg, rgba(59,195,34,1) 0%, rgba(45,178,253,1) 100%);",position:"absolute",borderRadius:"50%"},avatar:{position:"relative",display:"flex",justifyContent:"center"},searchUserInput:(t={},Object(y.a)(t,e.breakpoints.down("xs"),{display:"none"}),Object(y.a)(t,"padding","10px"),t),authUser:Object(y.a)({},e.breakpoints.down("xs"),{display:"none"}),authUserContainer:{display:"flex",justifyContent:"center"},lastMessage:Object(y.a)({},e.breakpoints.down("xs"),{display:"none"}),listItem:Object(y.a)({},e.breakpoints.down("xs"),{display:"flex",flexDirection:"column"}),messageArea:{height:"70vh",overflowY:"auto"},usersList:{height:"400px",overflowY:"scroll","&::-webkit-scrollbar":{width:"5px"},"&::-webkit-scrollbar-track":{backgroundColor:"transparent",borderRadius:"10px"},"&::-webkit-scrollbar-thumb":{borderRadius:"10px",visibility:"hidden;","background\u0421olor":"rgba(73, 43, 107, 0.952);"},"&:hover::-webkit-scrollbar-thumb":{visibility:"visible;",transition:"all 0.2s ease;"}}})})),E=function(e){var t=e.children,n=v();return Object(r.jsx)(p.a,{container:!0,className:n.root,children:Object(r.jsx)(p.a,{container:!0,item:!0,className:n.container,children:t})})},C=n(23),N=n(229),T=n(236),D=n(96),I=n(228),M=n(225),R=n(226),A=n(227),U=n(241),_=n(91),L=n.n(_),B=m.c;!function(e){e.SET_USERS="SET_USERS",e.SET_USER_MESSAGES="SET_USER_MESSAGES",e.SET_SELECTED_USER="SET_SELECTED_USER",e.ADD_MESSAGE="ADD_MESSAGE",e.ADD_REACTION="ADD_REACTION"}(a||(a={}));function W(){var e=Object(g.a)(["\n  query getUsers {\n    getUsers {\n      username\n      createdAt\n      imageUrl\n      latestMessage {\n        uuid\n        from\n        to\n        content\n        createdAt\n      }\n    }\n  }\n"]);return W=function(){return e},e}var $,G=Object(O.gql)(W()),q=function(e){return{user:e.authData.user,users:e.usersData.users}},P=function(){var e,t,n=Object(s.useState)(""),i=Object(C.a)(n,2),o=i[0],c=i[1],l=Object(s.useState)([]),u=Object(C.a)(l,2),d=u[0],b=u[1],j=B(q),g=j.user,x=j.users,h=k(),f=Object(m.b)(),v=null===x||void 0===x||null===(e=x.find((function(e){return!0===e.selected})))||void 0===e?void 0:e.username,y=Object(O.useQuery)(G,{onCompleted:function(e){b(e.getUsers),f(function(e){return{type:a.SET_USERS,payload:e}}(e.getUsers))},onError:function(e){return console.log(e)}}).loading;return Object(s.useEffect)((function(){var e;e=null===x||void 0===x?void 0:x.filter((function(e){return e.username.startsWith(o.toLowerCase())})),b(e)}),[o]),!d||y?t=Object(r.jsx)(D.a,{variant:"body2",className:h.usersMarkup,children:"Loading.."}):0===d.length?t=Object(r.jsx)(D.a,{variant:"body2",className:h.usersMarkup,children:"No users"}):d.length>0&&(t=d.map((function(e){var t,n=v===e.username;return Object(r.jsxs)(M.a,{className:h.listItem,alignItems:"center",button:!0,onClick:function(){return f((t=e.username,{type:a.SET_SELECTED_USER,payload:t}));var t},selected:n,children:[Object(r.jsxs)(R.a,{className:h.avatar,children:[Object(r.jsx)(U.a,{alt:e.username,src:e.imageUrl||"https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y"}),Object(r.jsx)("div",{className:h.onlineIcon})]}),Object(r.jsx)(A.a,{className:h.userInfo,primary:e.username,secondary:Object(r.jsx)(D.a,{className:h.lastMessage,component:"span",variant:"body2",color:"textSecondary",children:e.latestMessage?e.latestMessage.content:"You are connected!"})}),Object(r.jsx)(A.a,{className:h.latestMessageTimeBox,secondary:L()(null===(t=e.latestMessage)||void 0===t?void 0:t.createdAt).format("h:mm a")})]},e.username)}))),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(I.a,{children:Object(r.jsxs)(M.a,{className:h.authUserContainer,children:[Object(r.jsx)(R.a,{children:Object(r.jsx)(U.a,{alt:"user",src:"https://bain.design/wp-content/uploads/2013/03/People-Avatar-Set-Rectangular-18.jpg"})}),Object(r.jsx)(A.a,{className:h.authUser,primary:g.username})]},"user")}),Object(r.jsx)(N.a,{}),Object(r.jsx)(p.a,{item:!0,xs:12,className:h.searchUserInput,children:Object(r.jsx)(T.a,{value:o,onChange:function(e){var t=e.target;return c(t.value)},id:"outlined-basic-email",label:"Search",variant:"outlined",fullWidth:!0})}),Object(r.jsx)(N.a,{}),Object(r.jsx)(I.a,{className:h.usersList,children:t})]})},z=n(237),F=n(232),Q=n(230);!function(e){e.LOGIN="LOGIN",e.LOGOUT="LOGOUT"}($||($={}));var Y=n(135),H=n.n(Y),J=n(136),V=n.n(J),K=n(238),X=["\u2764\ufe0f","\ud83d\ude06","\ud83d\ude2f","\ud83d\ude22","\ud83d\ude21","\ud83d\udc4d","\ud83d\udc4e","\ud83d\ude0e"];function Z(){var e=Object(s.useState)(null),t=Object(C.a)(e,2),n=t[0],a=t[1],r=Boolean(n);return[n,a,function(e){a(e.currentTarget)},function(){a(null)},r,r?"simple-popover":void 0]}function ee(){var e=Object(g.a)(["\n  mutation reactToMessage($uuid: String!, $content: String!) {\n    reactToMessage(uuid: $uuid, content: $content) {\n      uuid\n    }\n  }\n"]);return ee=function(){return e},e}var te=function(e){return{user:e.authData.user}},ne=Object(O.gql)(ee()),ae=function(e){var t,n,a,s=e.message,i=e.image,o=B(te).user,c=w(),l=Z(),u=Object(C.a)(l,6),d=u[0],b=u[1],j=u[2],m=u[3],g=u[4],p=u[5],x=s.from===o.username,h=!x,f=Array.from(new Set(null===s||void 0===s||null===(t=s.reactions)||void 0===t?void 0:t.map((function(e){return e.content})))),v=Object(O.useMutation)(ne,{onError:function(e){return console.log(e)},onCompleted:function(){return b(!1)}}),y=Object(C.a)(v,1)[0];return Object(r.jsxs)(z.a,{alignSelf:h?"flex-start":"flex-end",display:"flex",children:[h&&Object(r.jsx)(U.a,{style:{marginRight:"7px"},alt:s.from,src:i||"U"}),Object(r.jsxs)(z.a,{className:c.messageBox,children:[Object(r.jsx)(z.a,{className:"".concat(c.messageText," ").concat(x?c.selfMessageText:null),onClick:j,children:s.content}),Object(r.jsx)(K.a,{id:p,open:g,anchorEl:d,onClose:m,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(r.jsx)(z.a,{className:c.reactionsBox,children:X.map((function(e){return Object(r.jsx)("b",{className:c.reaction,onClick:function(){return function(e){y({variables:{uuid:s.uuid,content:e}})}(e)},children:e},e)}))})}),Object(r.jsx)(D.a,{variant:"body2",color:"textSecondary",align:h?"right":"left",children:L()(s.createdAt).format("MMM DD @ h:mm a")}),0!==(null===s||void 0===s||null===(n=s.reactions)||void 0===n?void 0:n.length)&&Object(r.jsxs)(z.a,{className:h?c.emoji:c.emojiRight,children:[f," ",null===s||void 0===s||null===(a=s.reactions)||void 0===a?void 0:a.length]})]})]})},re=n(239);var se=function(e){var t=e.message,n=e.setErrors,a=e.expiresIn,i=f();return Object(s.useEffect)((function(){var e=setTimeout((function(){n("")}),a);return function(){clearTimeout(e)}}),[t]),Object(r.jsx)(z.a,{className:i.container,children:Object(r.jsx)(re.a,{elevation:6,variant:"filled",severity:"warning",children:t})})};function ie(){var e=Object(g.a)(["\n  query getMessages($from: String!) {\n    getMessages(from: $from) {\n      uuid\n      from\n      to\n      content\n      createdAt\n      reactions {\n        uuid\n        content\n      }\n    }\n  }\n"]);return ie=function(){return e},e}function oe(){var e=Object(g.a)(["\n  mutation sendMessage($to: String!, $content: String!) {\n    sendMessage(to: $to, content: $content) {\n      uuid\n      from\n      to\n      content\n      createdAt\n    }\n  }\n"]);return oe=function(){return e},e}var ce=function(e){return{users:e.usersData.users}},le=Object(O.gql)(oe()),ue=Object(O.gql)(ie());var de=function(){var e,t=Object(m.b)(),n=Object(s.useState)(""),o=Object(C.a)(n,2),c=o[0],l=o[1],u=Object(s.useState)(),d=Object(C.a)(u,2),b=d[0],j=d[1],g=S(),p=B(ce).users,x=null===p||void 0===p?void 0:p.find((function(e){return!0===e.selected})),h=null===x||void 0===x?void 0:x.messages,f=Object(O.useLazyQuery)(ue),v=Object(C.a)(f,2),y=v[0],w=v[1],k=w.loading,E=w.data,T=Object(O.useMutation)(le,{onError:function(e){return j(e)}}),_=Object(C.a)(T,1)[0];return Object(s.useEffect)((function(){x&&!x.messages&&y({variables:{from:x.username}})}),[x]),Object(s.useEffect)((function(){var e;E&&t((e={username:null===x||void 0===x?void 0:x.username,messages:E.getMessages},{type:a.SET_USER_MESSAGES,payload:e}))}),[E]),h||k?k?e=Object(r.jsx)(D.a,{variant:"overline",children:"Loading.."}):0!==(null===h||void 0===h?void 0:h.length)?e=null===h||void 0===h?void 0:h.map((function(e){return Object(r.jsx)(i.a.Fragment,{children:Object(r.jsx)(ae,{image:null===x||void 0===x?void 0:x.imageUrl,message:e})},e.uuid)})):0===(null===h||void 0===h?void 0:h.length)&&(e=Object(r.jsx)(D.a,{variant:"overline",children:"You are now connected! send your first message!"})):e=Object(r.jsx)(D.a,{variant:"overline",children:"Select a friend"}),Object(r.jsxs)(z.a,{className:g.container,children:[Object(r.jsxs)(z.a,{children:[Object(r.jsx)(I.a,{children:Object(r.jsxs)(M.a,{className:g.messagesHeader,children:[Object(r.jsx)(R.a,{children:Object(r.jsx)(U.a,{alt:"user",src:x?x.imageUrl:""})}),Object(r.jsx)(A.a,{style:{textTransform:"uppercase"},primary:x?x.username:""}),Object(r.jsx)(A.a,{className:g.logoutButton,children:Object(r.jsx)(F.a,{onClick:function(){t({type:$.LOGOUT}),window.location.href="/login"},children:Object(r.jsx)(H.a,{})})})]},"RemySharp")}),Object(r.jsx)(N.a,{})]}),Object(r.jsx)(z.a,{className:g.main,display:"flex",flexDirection:"column",children:e}),Object(r.jsxs)(z.a,{className:g.footer,children:[b&&Object(r.jsx)(se,{message:b.message,setErrors:j,expiresIn:"2000"}),Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),""!==c.trim()&&x&&(c.length&&_({variables:{to:x.username,content:c}}),l(""))},className:g.form,children:[Object(r.jsx)(Q.a,{disableUnderline:!0,type:"text",placeholder:"type your message",className:g.input,value:c,onChange:function(e){var t=e.target;return l(t.value)}}),Object(r.jsx)(F.a,{type:"submit",className:g.button,children:Object(r.jsx)(V.a,{})})]})]})]})},be=Object(x.a)((function(e){return Object(h.a)({rightBlock:{},content:Object(y.a)({position:"relative",zIndex:2,borderRadius:"20px",justifyContent:"space-around",background:"linear-gradient(90deg, rgba(2,0,36,1) 20%, rgba(121,9,117,0.40379901960784315) 50%, rgba(0,212,255,0.2) 90%);"},e.breakpoints.down("xs"),{})})})),je=Object(x.a)((function(e){return Object(h.a)({root:{display:"flex",background:"linear-gradient(90deg, rgba(2,0,36,1) 20%, rgba(121,9,117,0.40379901960784315) 50%, rgba(0,212,255,0.2) 90%);"},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center",padding:"20px"},textBlock:{position:"relative",zIndex:10,MaxWidth:"400px",padding:"10px",alignSelf:"center",marginLeft:"15px",marginTop:"80px"},title:{fontFamily:"'Space Grotesk', sans-serif;"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)},rightColumn:Object(y.a)({background:"url('./happyf.jpg') no-repeat center ;",backgroundSize:" cover;",position:"relative","&::after":{position:"absolute",content:"''",width:"100%",height:"100%",top:"0",left:"0",background:"linear-gradient(0deg, rgba(34,89,195,0.4) 0%, rgba(16,222,255,0.4) 100%);"}},e.breakpoints.down("xs"),{display:"none"})})})),me=Object(x.a)((function(e){return Object(h.a)({root:{display:"flex",height:"450px",background:"linear-gradient(90deg, rgba(2,0,36,1) 20%, rgba(121,9,117,0.40379901960784315) 50%, rgba(0,212,255,0.2) 90%);"},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center",padding:"20px"},textBlock:{position:"relative",zIndex:10,MaxWidth:"400px",padding:"10px",alignSelf:"center",marginLeft:"15px",marginTop:"80px"},title:{fontFamily:"'Space Grotesk', sans-serif;"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)},rightColumn:Object(y.a)({background:"url('./girl.jpg') no-repeat center ;",backgroundSize:" cover;",position:"relative","&::after":{position:"absolute",content:"''",width:"100%",height:"100%",top:"0",left:"0",background:"linear-gradient(0deg, rgba(34,89,195,0.4) 0%, rgba(16,222,255,0.4) 100%);"}},e.breakpoints.down("xs"),{display:"none"})})}));function ge(){var e=Object(g.a)(["\n  subscription newReaction {\n    newReaction {\n      uuid\n      content\n      message {\n        uuid\n        from\n        to\n      }\n    }\n  }\n"]);return ge=function(){return e},e}function pe(){var e=Object(g.a)(["\n  subscription newMessage {\n    newMessage {\n      uuid\n      from\n      to\n      content\n      createdAt\n    }\n  }\n"]);return pe=function(){return e},e}var Oe=Object(O.gql)(pe()),xe=Object(O.gql)(ge()),he=function(e){return{user:e.authData.user}},fe=function(){var e=Object(m.b)(),t=be(),n=B(he).user,i=Object(O.useSubscription)(Oe),o=i.data,c=i.error,l=Object(O.useSubscription)(xe),u=l.data,d=l.error;return Object(s.useEffect)((function(){if(c&&console.log(c),o){var t=o.newMessage;console.log(t);var r=n.username===t.to?t.from:t.to;e((s={username:r,message:t},{type:a.ADD_MESSAGE,payload:s}))}var s}),[c,o]),Object(s.useEffect)((function(){if(d&&console.log(d),u){var t=u.newReaction,r=n.username===t.message.to?t.message.from:t.message.to;e((s={username:r,reaction:t},{type:a.ADD_REACTION,payload:s}))}var s}),[d,u]),Object(r.jsx)(E,{children:Object(r.jsxs)(p.a,{className:t.content,container:!0,item:!0,sm:12,md:10,lg:8,children:[Object(r.jsx)(p.a,{item:!0,xs:3,sm:4,md:4,children:Object(r.jsx)(P,{})}),Object(r.jsx)(p.a,{item:!0,xs:8,className:t.rightBlock,children:Object(r.jsx)(de,{})})]})})},ve=n(10),ye=n(233);function Se(){var e=Object(g.a)(["\n  mutation register(\n    $username: String!\n    $email: String!\n    $password: String!\n    $confirmPassword: String!\n  ) {\n    register(\n      username: $username\n      email: $email\n      password: $password\n      confirmPassword: $confirmPassword\n    ) {\n      username\n      email\n      createdAt\n    }\n  }\n"]);return Se=function(){return e},e}var we=Object(O.gql)(Se()),ke=function(e){var t=e.history,n=je(),a=Object(s.useState)({email:"",username:"",password:"",confirmPassword:""}),i=Object(C.a)(a,2),o=i[0],c=i[1],u=Object(s.useState)({}),d=Object(C.a)(u,2),b=d[0],j=d[1],m=Object(O.useMutation)(we,{update:function(e,n){return t.push("/login")},onError:function(e){return j(e.graphQLErrors[0].extensions.errors)}}),g=Object(C.a)(m,1)[0];return Object(r.jsx)(E,{children:Object(r.jsxs)(p.a,{xs:11,md:8,className:n.root,children:[Object(r.jsx)(p.a,{item:!0,xs:12,sm:6,md:6,lg:6,children:Object(r.jsxs)("div",{className:n.paper,children:[Object(r.jsx)(D.a,{component:"h1",variant:"h5",children:"Sign up"}),Object(r.jsxs)("form",{className:n.form,noValidate:!0,onSubmit:function(e){e.preventDefault(),g({variables:o})},children:[Object(r.jsxs)(p.a,{container:!0,spacing:2,children:[Object(r.jsx)(p.a,{item:!0,xs:12,children:Object(r.jsx)(T.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",value:o.email,onChange:function(e){return c(Object(ve.a)(Object(ve.a)({},o),{},{email:e.target.value}))},error:b.email,helperText:b.email})}),Object(r.jsx)(p.a,{item:!0,xs:12,children:Object(r.jsx)(T.a,{variant:"outlined",required:!0,fullWidth:!0,name:"username",label:"Username",id:"username",value:o.username,onChange:function(e){return c(Object(ve.a)(Object(ve.a)({},o),{},{username:e.target.value}))}})}),Object(r.jsx)(p.a,{item:!0,xs:12,children:Object(r.jsx)(T.a,{autoComplete:"fname",name:"password",variant:"outlined",required:!0,fullWidth:!0,id:"password",type:"password",label:"Password",autoFocus:!0,value:o.password,onChange:function(e){return c(Object(ve.a)(Object(ve.a)({},o),{},{password:e.target.value}))}})}),Object(r.jsx)(p.a,{item:!0,xs:12,children:Object(r.jsx)(T.a,{variant:"outlined",required:!0,fullWidth:!0,id:"ConfirmPassword",label:"Confirm Password",type:"password",name:"ConfirmPassword",value:o.confirmPassword,onChange:function(e){return c(Object(ve.a)(Object(ve.a)({},o),{},{confirmPassword:e.target.value}))},error:b.confirmPassword,helperText:b.confirmPassword})})]}),Object(r.jsx)(ye.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:n.submit,children:"Sign Up"}),Object(r.jsx)(p.a,{container:!0,justify:"center",children:Object(r.jsx)(p.a,{item:!0,children:Object(r.jsx)(l.b,{to:"./login",color:"white",children:Object(r.jsx)(D.a,{variant:"overline",color:"textSecondary",children:"Already have an account? Sign in"})})})})]})]})}),Object(r.jsx)(p.a,{container:!0,item:!0,xs:6,className:n.rightColumn,children:Object(r.jsxs)(p.a,{item:!0,className:n.textBlock,children:[Object(r.jsx)(D.a,{variant:"h4",className:n.title,children:"InContact Messenger"}),Object(r.jsx)(D.a,{children:"be in contact with important people for you"})]})})]})})};function Ee(){var e=Object(g.a)(["\n  query login($username: String!, $password: String!) {\n    login(username: $username, password: $password) {\n      username\n      email\n      createdAt\n      token\n    }\n  }\n"]);return Ee=function(){return e},e}var Ce=Object(O.gql)(Ee()),Ne=function(){var e=Object(m.b)(),t=Object(s.useState)({}),n=Object(C.a)(t,2),a=n[0],i=n[1],o=Object(s.useState)({username:"",password:""}),c=Object(C.a)(o,2),u=c[0],d=c[1],b=me(),j=Object(O.useLazyQuery)(Ce,{onError:function(e){return i(e.graphQLErrors[0].extensions.errors)},onCompleted:function(t){var n;e((n=t.login,{type:$.LOGIN,payload:n}))}}),g=Object(C.a)(j,2),x=g[0],h=g[1].loading;return Object(r.jsx)(E,{children:Object(r.jsxs)(p.a,{xs:10,className:b.root,children:[Object(r.jsx)(p.a,{item:!0,xs:12,sm:6,md:6,lg:6,children:Object(r.jsxs)("div",{className:b.paper,children:[Object(r.jsx)(D.a,{component:"h1",variant:"h5",children:"Sign In"}),Object(r.jsxs)("form",{className:b.form,noValidate:!0,onSubmit:function(e){e.preventDefault(),x({variables:u})},children:[Object(r.jsxs)(p.a,{container:!0,spacing:2,children:[Object(r.jsx)(p.a,{item:!0,xs:12,children:Object(r.jsx)(T.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Username",name:"Username",value:u.username,onChange:function(e){return d(Object(ve.a)(Object(ve.a)({},u),{},{username:e.target.value}))},error:!!a.username,helperText:a.username&&a.username})}),Object(r.jsx)(p.a,{item:!0,xs:12,children:Object(r.jsx)(T.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",value:u.password,onChange:function(e){return d(Object(ve.a)(Object(ve.a)({},u),{},{password:e.target.value}))},error:!!a.password,helperText:a.password&&a.password})}),Object(r.jsx)(p.a,{item:!0,xs:12})]}),Object(r.jsx)(ye.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:b.submit,disabled:h,children:h?"loading..":"Sign In"}),Object(r.jsx)(p.a,{container:!0,justify:"center",children:Object(r.jsx)(p.a,{item:!0,children:Object(r.jsx)(l.b,{to:"./register",children:Object(r.jsx)(D.a,{variant:"overline",color:"textSecondary",children:"Don't have an account? Sign Up"})})})})]})]})}),Object(r.jsx)(p.a,{container:!0,item:!0,xs:6,className:b.rightColumn,children:Object(r.jsxs)(p.a,{item:!0,className:b.textBlock,children:[Object(r.jsx)(D.a,{variant:"h4",className:b.title,children:"Let's Talk Messenger"}),Object(r.jsx)(D.a,{variant:"subtitle2",children:"be in contact with important people for you"})]})})]})})},Te=n(137),De=n(138),Ie=n(3),Me=Object(O.createHttpLink)({uri:"/graphql"});Me=Object(Te.a)((function(e,t){var n=t.headers,a=localStorage.getItem("token");return{headers:Object(ve.a)(Object(ve.a)({},n),{},{authorization:a?"Bearer ".concat(a):""})}})).concat(Me);var Re=window.location.host,Ae=new De.a({uri:"ws://".concat(Re,"/graphql/"),options:{reconnect:!0,connectionParams:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}}),Ue=Object(O.split)((function(e){var t=e.query,n=Object(Ie.p)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),Ae,Me),_e=new O.ApolloClient({link:Ue,cache:new O.InMemoryCache});function Le(e){return Object(r.jsx)(O.ApolloProvider,Object(ve.a)({client:_e},e))}var Be=function(e){return{user:e.authData.user}},We=function(e){var t=B(Be).user;return e.authenticated&&!t?Object(r.jsx)(u.a,{to:"/login"}):e.guest&&t?Object(r.jsx)(u.a,{to:"/"}):Object(r.jsx)(u.b,Object(ve.a)({component:e.currentComponent},e))},$e=n(59),Ge=n(140),qe=n.n(Ge),Pe=n(141),ze=null,Fe=localStorage.getItem("token");if(Fe){var Qe=Object(Pe.a)(Fe),Ye=new Date(1e3*Qe.exp);new Date>Ye?localStorage.removeItem("token"):ze=Qe}else console.log("No token found");var He={user:ze},Je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $.LOGIN:return localStorage.setItem("token",t.payload.token),Object(ve.a)(Object(ve.a)({},e),{},{user:t.payload});case $.LOGOUT:return localStorage.removeItem("token"),Object(ve.a)(Object(ve.a)({},e),{},{user:null});default:return e}},Ve=n(50),Ke={users:[]},Xe=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ke,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case a.SET_USERS:return Object(ve.a)(Object(ve.a)({},n),{},{users:r.payload});case a.SET_USER_MESSAGES:var s=r.payload,i=s.username,o=s.messages;return t=(e=Object(Ve.a)(n.users)).findIndex((function(e){return e.username===i})),e[t]=Object(ve.a)(Object(ve.a)({},e[t]),{},{messages:o}),Object(ve.a)(Object(ve.a)({},n),{},{users:e});case a.SET_SELECTED_USER:return e=(e=Object(Ve.a)(n.users)).map((function(e){return Object(ve.a)(Object(ve.a)({},e),{},{selected:e.username===r.payload})})),Object(ve.a)(Object(ve.a)({},n),{},{users:e});case a.ADD_MESSAGE:var c=r.payload.message;t=(e=Object(Ve.a)(n.users)).findIndex((function(e){return e.username===r.payload.username})),c.reactions=[];var l=Object(ve.a)(Object(ve.a)({},e[t]),{},{messages:e[t].messages?[c].concat(Object(Ve.a)(e[t].messages)):null,latestMessage:c});return e[t]=l,Object(ve.a)(Object(ve.a)({},n),{},{users:e});case a.ADD_REACTION:var u=r.payload.reaction;t=(e=Object(Ve.a)(n.users)).findIndex((function(e){return e.username===r.payload.username}));var d=Object(ve.a)({},e[t]),b=d.messages.findIndex((function(e){return e.uuid===u.message.uuid}));if(b>-1){var j=Object(Ve.a)(d.messages),m=Object(Ve.a)(j[b].reactions),g=m.findIndex((function(e){return e.uuid===u.uuid}));return g>-1?m[g]=u:m=[].concat(Object(Ve.a)(m),[u]),j[b]=Object(ve.a)(Object(ve.a)({},j[b]),{},{reactions:m}),d=Object(ve.a)(Object(ve.a)({},d),{},{messages:j}),e[t]=d,Object(ve.a)(Object(ve.a)({},n),{},{users:e})}return n;default:return n}},Ze=Object($e.c)({authData:Je,usersData:Xe}),et=[qe.a],tt=Object($e.d)(Ze,$e.a.apply(void 0,et)),nt=Object(d.a)({typography:{fontFamily:"'Space Grotesk', sans-serif;"},palette:{type:"dark",primary:{main:j.a[400]}}}),at=function(){return Object(r.jsx)(m.a,{store:tt,children:Object(r.jsx)(Le,{children:Object(r.jsx)(l.a,{children:Object(r.jsx)(b.a,{theme:nt,children:Object(r.jsx)("div",{className:"App",children:Object(r.jsxs)(u.d,{children:[Object(r.jsx)(We,{exact:!0,path:"/",currentComponent:fe,authenticated:!0}),Object(r.jsx)(We,{path:"/register",currentComponent:ke,guest:!0}),Object(r.jsx)(We,{path:"/login",currentComponent:Ne,guest:!0})]})})})})})})};c.a.render(Object(r.jsx)(at,{}),document.getElementById("root"))}},[[184,1,2]]]);
//# sourceMappingURL=main.8fb062e6.chunk.js.map